sample_rate: 24000
llm_input_size: 896
llm_output_size: 896
spk_embed_dim: 192
qwen_pretrain_path: ''
token_frame_rate: 25
token_mel_ratio: 2

# stream related params
chunk_size: 25  # streaming inference chunk size, in token
num_decoding_left_chunks: -1  # streaming inference flow decoder left chunk size, <0 means use all left chunks


feat_extractor:
  class: matcha.utils.audio.mel_spectrogram
  params:
    n_fft: 1920
    num_mels: 80
    sampling_rate: 24000   # 原来是 !ref <sample_rate>，这里直接写数值
    hop_size: 480
    win_size: 1920
    fmin: 0
    fmax: 8000
    center: false

flow:
  input_size: 512
  output_size: 80
  spk_embed_dim: 192
  output_type: "mel"
  vocab_size: 6561
  input_frame_rate: 25
  only_mask_loss: true
  token_mel_ratio: 2
  pre_lookahead_len: 3
  encoder:
    output_size: 512
    attention_heads: 8
    linear_units: 2048
    num_blocks: 6
    dropout_rate: 0.1
    positional_dropout_rate: 0.1
    attention_dropout_rate: 0.1
    normalize_before: true
    input_layer: "linear"
    pos_enc_layer_type: "rel_pos_espnet"
    selfattention_layer_type: "rel_selfattn"
    input_size: 512
    use_cnn_module: false
    macaron_style: false
    static_chunk_size: 25
  decoder:
    in_channels: 240
    n_spks: 1
    spk_emb_dim: 80
    cfm_params:
      sigma_min: 1e-06
      solver: "euler"
      t_scheduler: "cosine"
      training_cfg_rate: 0.2
      inference_cfg_rate: 0.7
      reg_loss_type: "l1"
    estimator:
      in_channels: 320
      out_channels: 80
      channels: [256]
      dropout: 0.0
      attention_head_dim: 64
      n_blocks: 4
      num_mid_blocks: 12
      num_heads: 8
      act_fn: "gelu"
      static_chunk_size: 50   # 25 * 2
      num_decoding_left_chunks: -1



hift:
  class: cosyvoice.hifigan.generator.HiFTGenerator
  params:
    in_channels: 80
    base_channels: 512
    nb_harmonics: 8
    sampling_rate: 24000   # 原来是 !ref <sample_rate>，这里直接写数值
    nsf_alpha: 0.1
    nsf_sigma: 0.003
    nsf_voiced_threshold: 10
    upsample_rates: [8, 5, 3]
    upsample_kernel_sizes: [16, 11, 7]
    istft_params:
      n_fft: 16
      hop_len: 4
    resblock_kernel_sizes: [3, 7, 11]
    resblock_dilation_sizes: [[1, 3, 5], [1, 3, 5], [1, 3, 5]]
    source_resblock_kernel_sizes: [7, 7, 11]
    source_resblock_dilation_sizes: [[1, 3, 5], [1, 3, 5], [1, 3, 5]]
    lrelu_slope: 0.1
    audio_limit: 0.99
    f0_predictor:
      class: cosyvoice.hifigan.f0_predictor.ConvRNNF0Predictor
      params:
        num_class: 1
        in_channels: 80
        cond_channels: 512